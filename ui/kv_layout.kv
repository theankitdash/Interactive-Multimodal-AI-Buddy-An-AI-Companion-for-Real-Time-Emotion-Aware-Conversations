<RootWidget>:
    FloatLayout:

        # ---------------- Camera Full Screen ----------------
        Image:
            id: camera_preview
            size_hint: 1, 1
            pos_hint: {"x":0, "y":0}
            allow_stretch: True
            keep_ratio: True
            canvas.before:
                Color:
                    rgba: (0.1,0.1,0.13,1)
                Rectangle:
                    pos: self.pos
                    size: self.size

        # ---------------- UI Overlay ----------------
        BoxLayout:
            orientation: "vertical"
            size_hint: 0.35, 0.5
            pos_hint: {"x":0.325, "y":0.2}  # center overlay
            spacing: "12dp"

            # Username input (registration only)
            TextInput:
                id: username_input
                hint_text: "Username"
                size_hint_y: None
                height: "44dp"
                background_normal: ""
                background_color: (0.18, 0.18, 0.22, 1)
                foreground_color: (1,1,1,1)
                padding: ["12dp","10dp"]
                radius: [12,]
                opacity: 1 if root.mode=='register' else 0
                disabled: False if root.mode=='register' else True

            # Full Name input (registration only)
            TextInput:
                id: fullname_input
                hint_text: "Full Name"
                size_hint_y: None
                height: "44dp"
                background_normal: ""
                background_color: (0.18, 0.18, 0.22, 1)
                foreground_color: (1,1,1,1)
                padding: ["12dp","10dp"]
                radius: [12,]
                opacity: 1 if root.mode=='register' else 0
                disabled: False if root.mode=='register' else True

            # Status label
            Label:
                id: status_label
                size_hint_y: None
                height: "24dp"
                color: (0.8,0.85,0.9,1)
                text: ""

            # Action button (Login/Register)
            Button:
                id: action_button
                text: "Login" if root.mode=="login" else "Register"
                size_hint_y: None
                height: "48dp"
                opacity: 0 if root.mode=="assistant" else 1
                disabled: True if root.mode=="assistant" else False
                background_normal: ""
                background_color: (0.24, 0.49, 1, 1)
                color: (1,1,1,1)
                font_size: "16sp"
                bold: True
                radius: [14,]
                on_release: root.do_action()

            # Toggle Login/Register
            Button:
                id: switch_button
                text: "Switch to Register" if root.mode=="login" else "Switch to Login"
                size_hint_y: None
                height: "44dp"
                opacity: 0 if root.mode=="assistant" else 1
                disabled: True if root.mode=="assistant" else False
                background_normal: ""
                background_color: (0.16,0.16,0.19,1)
                color: (0.8,0.85,0.9,1)
                font_size: "14sp"
                radius: [12,]
                on_release: root.toggle_mode()
